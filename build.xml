<?xml version="1.0" encoding="utf-8"?>
<project name="nModule" default="all-targets">
	
	<target name="open-targets" depends="compile-nunit,execute-unittests-nunit" />
	<target name="ms-targets" depends="compile-mstest,execute-unittests-mstest" />
	<target name="all-targets" depends="open-targets,ms-targets" />

	<!-- open-targets -->
	<target name="compile-nunit">
		<exec
		 dir='.'
		 executable='${build.tools.msbuild4.0}'
		 failonerror='true'>
			<arg line='"nModule.sln"' />
			<arg line='/p:Configuration=Release' />
			<arg line='/p:WarningLevel=4' />
			<arg line='/p:TreatWarningsAsErrors=true' />
			<arg line='/p:DevEnvDir="c:\Program Files\Microsoft Visual Studio 9.0\Common7\IDE"' />
			<arg line='/T:Clean;Build' />
			<arg line='/verbosity:minimal' />
			<arg line='/nologo' />
		</exec>
	</target>
	<target name="execute-unittests-nunit">
		<exec
		 dir='.'
		 executable='${build.tools.nunit}'
		 failonerror='true'>
			<arg line='/result="${build.output.unittestsfile}"' />
			<arg line='"nModule.UnitTests\bin\Release\nModule.UnitTests.dll"' />
		</exec>
	</target>

	<!-- nunit-targets -->
	<target name="compile-mstest">
		<exec
		 dir='.'
		 executable='${build.tools.msbuild4.0}'
		 failonerror='true'>
			<arg line='"nModule.sln"' />
			<arg line='/p:Configuration=Release' />
			<arg line='/p:WarningLevel=4' />
			<arg line='/p:TreatWarningsAsErrors=true' />
			<arg line='/p:DevEnvDir="c:\Program Files\Microsoft Visual Studio 9.0\Common7\IDE"' />
			<arg line='/p:DefineConstants="MSTest"' />
			<arg line='/T:Clean;Build' />
			<arg line='/verbosity:minimal' />
			<arg line='/nologo' />
		</exec>
	</target>
	<target name='execute-unittests-mstest'>
		<exec
			executable="${build.tools.mstest}"
			failonerror="true">
			<arg line="/testcontainer:nModule.UnitTests\bin\Release\nModule.UnitTests.dll" />
		</exec>	
	</target>
		
</project>